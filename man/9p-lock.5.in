.TH 9p-lock 5 "@META_DATE@" "@META_ALIAS@" "@META_NAME@"
.SH NAME
9p lock \- acquire/release POSIX advisory byte range locks
.SH SYNOPSIS
.nf
size[4] TLock tag[2] fid[4] flock[n]
size[4] RLock tag[2] status[1]
.fi
.SH DESCRIPTION
Tlock is used to acquire/release byte range posix locks on a file
identified by given fid.  The flock structure contains:
.TP
\fItype[1]\fR
Type of lock: F_RDLCK, F_WRLCK, F_UNLCK
.TP
\fIflags[4]\fR
Flags could be either of
.nf
P9_LOCK_FLAGS_BLOCK - Blocked lock request, if there is a
conflicting lock exists, wait for that lock to be released.
.nf
P9_LOCK_FLAGS_RECLAIM - Reclaim lock request, used when client is
trying to reclaim a lock after a server restrart (due to crash)
.TP
\fIstart[8]\fR
Starting offset for lock
.TP
\fIlength[8]\fR
Number of bytes to lock.
If length is 0, lock all bytes starting at the location 'start'
through to the end of file.
.TP
\fIpid[4]\fR
PID of the process that wants to take lock
.TP
\fIclient_id[4]\fR
Unique client id.
.LP
The possible values for status[1] in the reply are:
.nf
P9_LOCK_SUCCESS (0) - Request was successful
.nf
P9_LOCK_BLOCKED (1) - A conflicting lock is held by another process
.nf
P9_LOCK_ERROR (2) - Error while processing the lock request
.nf
P9_LOCK_GRACE (3) - Server is in grace period, it can't accept new lock
requests in this period (except locks with P9_LOCK_FLAGS_RECLAIM flag set)
.fi
.SH ORIGIN
9P2000.L
.SH SEE ALSO
9p-intro(5)
