.TH diodmount 8 "@META_DATE@" "@META_ALIAS@" "@META_NAME@"
.SH NAME
diodmount \- mount diod file systems
.SH SYNOPSIS
\fBdiodmount\fR \fI[OPTIONS] host:aname dir\fR
.nf
\fBdiodmount\fR \fI[OPTIONS] -a host [dir-prefix]\fR
.SH DESCRIPTION
.B diodmount
is the mount utility for the distributed I/O daemon, which is an I/O
forwarding service for Linux clusters.
Usually \fBdiodmount\fR first interacts with the \fBdiodctl\fR superserver,
which dynamically starts servers and lists exported file systems.
Then it uses this information to perform one or more \fBdiod\fR mounts.
All file system interactions are authenticated with MUNGE.
.LP
This command must be run as root.
.SH OPTIONS
.TP
.I "-a, --all"
Mount all file systems exported by \fIHOST\fR (omit aname path).
If a directory argument is specified, it will be prepended to
the server directory names when constructing mount points.
.TP
.I "-u, --mount-user USER"
Start a private server for \fIUSER\fR if one is not already running,
and mount so that only \fIUSER\fR can access the file system
(-o access=<uid>, where <uid> is \fIUSER\fR's uid).
The default (eqivalent to -u root) is to start a shared server as root
if one is not already running,
and mount so that any user can access the file system
(-o access=user).
.TP
.I "-D, --create-directories"
Recursively create mount point directories as needed, mode 0755.
.TP
.I "-n, --no-mtab"
Do not update /etc/mtab.  This may be appropriate, for example, when
the file system is mounted in a private name space.
.TP
.I "-j, --jobid STRING"
Pass a jobid or other arbitrary string to the \fBdiodctl\fR server.
The server uses the uid plus this string, if specified, as a unique key
to look up an existing \fBdiod\fR server that can handle the mount request.
This is intended for a batch cluster environment where one 
I/O forwarding server per job is desired, not the default of one per user.
.TP
.I "-f, --fake-mount"
Do everything but actually perform the diod mount/unmount.
.SH TESTING OPTIONS
The following options are mainly intended for testing.
.TP
.I "-s, --server CMD"
Start the \fBdiod\fR server as a child of \fBdiodmount\fR using \fICMD\fR.
It is mounted in a private namespace so there is an implicit unmount
when \fBdiodmount\fR exits.  This command would normally be used with
\fI-x\fR.  If \fI-u\fR is used, run CMD as USER.
.TP
.I "-x, --exec CMD"
Perform the mount(s) in a private name space, execute \fICMD\fR as a child
of \fBdiodmount\fR, then unmount and exit.
If \fI-u\fR is used, run \fICMD\fR as \fIUSER\fR.
.TP
.I "-o, --diod-options OPT,[OPT,...]"
Pass additional 9P mount options when mounting the \fBdiod\fR server.
These options override the ones \fBdiodmount\fR sets up internally.
.TP
.I "-O, --diodctl-options OPT,[OPT,...]"
Pass additional 9P mount options when mounting the \fBdiodctl\fR server.
These options override the ones \fBdiodmount\fR sets up internally.
.TP
.I "-v, --verbose"
Be verbose about what is going on.
.TP
.I "-p, --diod-port PORT"
Mount the \fBdiod\fR server on the specified port.
Do not contact \fBdiodctl\fR.
.TP
.I "-d, --v9fs-debug flag[,flag...]"
Set the specified global kernel 9p file system debug flags at mount time.
The following flags are valid:
error, 9p, vfs, conv, mux, trans, slabs, fcall, fid, pkt, fsc.
.SH "EXAMPLES"
.LP
Mount /g/g99 from tycho42, so that all users can access it:
.LP
.nf
    diodmount tycho42:/g/g99 /g/g99
.fi
.LP
Mount and unmount all file systems exported by tycho42 without updating
/etc/mtab, creating mount points as needed:
.LP
.nf
    diodmount -a -n -D tycho42
    diodmount -U -n tycho42
.fi
.LP
Mount /p/lcrater1 on tycho[101-164] without updating /etc/mtab, starting
a private server for garlick:
.LP
.nf
    pdsh -w tycho[101-164] \\
        diodmount -n -u garlick tycho42:/p/lcrater1 /p/lcrater1
.fi
.nf
.SH "SEE ALSO"
diod (8),
diodctl (8),
diod.conf (5)
