.TH diodctl 8 "@META_DATE@" "@META_ALIAS@" "@META_NAME@"
.SH NAME
diodctl \- distributed I/O daemon superserver
.SH SYNOPSIS
.B diodctl
.I "[OPTIONS]"
.SH DESCRIPTION
\fBdiodctl\fR is the distributed I/O daemon super-server, which 
dynamically starts \fBdiod\fR servers in tandem with requests received
from the diod mount helper, \fBmount.diod\fR.
It also supplies a list of exported file systems to the diod autofs
helper, \fBdiodexp\fR.
.LP
Configuration is read from the diod.conf (5) config file.
Some configuration can be overridden on the command line, as described below.
.SH OPTIONS
.TP
.I "-f, --foreground"
Do not change working directory to @X_LOCALSTATEDIR@/run,
drop the controlling terminal, or run in the background.
Send logs to stderr not syslog, unless sent somewhere else by \fI\-L\fR.
.TP
.I "-s, --stdin"
Serve a connected client inherited on stdin.
This option is mainly used in testing.
.TP
.I "-l, --listen IP:PORT"
Set the listen address (default 0.0.0.0:10005).
This option may be specified more than once.
It overrides the \fIdiodctllisten\fR config file setting.
.TP
.I "-w, --nwthreads INT"
Set the number of \fBdiodctl\fR worker threads to spawn handle 9P operations.
This overrides the \fInwthreads\fR setting in the config file.
The default is 16.
It is not inherited by any spawned \fBdiod\fR processes.
.TP
.I "-e, --export PATH"
Set the file system to be exported.
This option may be specified more than once.
It overrides the \fIexports\fR setting in diod.conf (5)
and is inherited by spawned \fBdiod\fR processes.
.TP
.I "-E, --export-all"
Export everything in the server's /proc/mounts.
This potion overrides the \fIexportall\fR setting in diod.conf (5)
and is inherited by spawned \fBdiod\fR processes.
.TP
.I "-n, --no-auth"
Allow users to attach without security credentials.
This option overrides the \fIauth_required\fR config file setting,
and is inherited by spawned \fBdiod\fR processes.
.TP
.I "-S, --allsquash"
Remap all users to "nobody".
The attaching user need not be present in the server's password file.
This option overrides the \fIallsquash\fR setting in diod.conf (5).
.TP
.I "-D, --diod-path PATH"
Override the default path to the \fBdiod\fR server executable.
.TP
.I "-L, --logdest DEST"
Set the destination for logging.  Possible destinations are
\fIsyslog:facility:level\fR,
\fIstderr\fR,
\fIstdout\fR, or
a file name.
This option is inherited by any spawned \fBdiod\fR processes.
It overrides the logdest setting in diod.conf (5).
.TP
.I "-d, --debug MASK"
Set the debug mask.  The bit values are:
.br
0x01 - log decoded 9P protocol messages
.br
The debug level is inherited by any spawned \fBdiod\fR processes.
.TP
.I "-c, --config-file PATH"
Set config file path.
.SH "NOTES"
\fBdiod\fR servers spawned by \fBdiodctl\fR can be shared by multiple
clients.  They are assigned random ports to listen on, which are given out
to clients upon request by \fBmount.diod\fR.
Servers run until they have had no connections for 30 seconds then terminate.
\fBdiodctl\fR reaps these children and logs their exit status.
.LP
\fBdiod\fR children of \fBdiodctl\fR are terminated when \fBdiodctl\fR
is shut down cleanly with a SIGTERM.
.LP
When \fBdiodctl\fR receives a SIGHUP, it rereads its config file.
Any original command line arguments will continue to override config file
values.   Although the signal propagates to \fBdiod\fR children,
not all changed values will have an effect on running servers.
For example, if an export is removed, the \fBdiod\fR server will not
allow new attaches but will continue to serve old ones.
.SH "FILES"
@X_SBINDIR@/diodctl
.br
@X_SYSCONFDIR@/diod.conf
.br
@X_SYSCONFDIR@/sysconfig/diodctl
.SH "SEE ALSO"
diod (8), mount.diod (8), diodexp (8), diod.conf (5), hosts_access (5)
